#### 莫比乌斯反演

最近写了不少数论题，感觉越做越上瘾是怎么回事。



#### 常用卷积关系

1. $\sum_{d \mid n} \mu(d) \frac nd = \varphi(n) \Leftrightarrow \mu \circ id = \varphi$
2. $\sum_{d \mid n} \varphi(d) = n \Leftrightarrow \varphi \circ 1 = id$
3. $\sum_{d \mid n} \mu(d) = [n = 1] \Leftrightarrow \mu \circ id = \varepsilon$

##### 莫比乌斯反演

$$
f(n) = \sum_{d \mid n} g(d) \Leftrightarrow g(n) = \sum_{d \mid n} \mu(d)f(\frac nd)
$$

其中`f`, `g`均为积性函数

$f(n)$ 称为 $g(n)$ 的莫比乌斯变换

$g(n)$ 称为 $f(n)$ 的莫比乌斯逆变换

证明如下：

1. 若$f = g \circ 1, 则 \mu \circ f = \mu \circ g \circ 1 = g \circ \mu \circ 1 = g \circ \varepsilon = g$

​	若$g = \mu \circ f, 则 g \circ 1 = \mu \circ f \circ 1 = f \circ \mu \circ 1 = f \circ \varepsilon = f$

2. 
   $$
   \begin{flalign}
   &\sum_{d \mid n} \mu(d)f(\frac nd) = \sum_{d \mid n} \mu(d) \sum_{k \mid \frac nd} g(k) &\\
   =& \sum_{d \mid n} \sum_{k \mid \frac nd} \mu(d)g(k) = \sum_{k \mid n}\sum_{d \mid \frac nk} \mu(d)g(k) \\
   = &\sum_{k \mid n}g(k)\sum_{d \mid \frac nk}\mu(d) = g(n)
   \end{flalign}
   $$



##### 下面是一些做题得到的结论

[P1829 [国家集训队\] Crash的数字表格 / JZPTAB - 洛谷](https://www.luogu.com.cn/problem/P1829)

对于$\sum_{d \mid n}d\mu(d)$ 类型的积性函数进行线性筛

设 $f(n) = \sum_{d \mid n} d\mu(d)$, 考虑质因子`p`与`d`的关系得到

$f(1) = 1$, $f(p) = 1 - p$, $f(p^k) = f(p)$，做一遍线性筛即可.





 

[P3327 [SDOI2015\] 约数个数和 - 洛谷](https://www.luogu.com.cn/problem/P3327)
$$
xy的约数个数 = 
\sigma_0(xy) = \sum_{i \mid x}\sum_{j \mid y}[gcd(x, y) = 1]
$$
证明如下:

考虑将每个因子一一映射

如果`xy`的因子`k`有一个因子$p^c$，`x`中有因子$p^a$，`y`中有因子$p^b$。

$\bullet$ 如果$c \le a$, 那么在`i`中选择

$\bullet$ 如果$c \ge a$, 那么把`c`减去`a`, 在`y`中选择$p^{c - a}$, (在`y`中选择 $p^e$ 表示的是 $p^{a + e}$)

对于`xy`的因子`k`的其他因子同理. 于是对任意一个 `k` 有一个唯一的映射, 且每一个选择对应唯一的 `k`.

通过如上过程我们发现：对于`xy`的因子 $k = \prod p_i^{c_i}$，我们不可能同时在 `x` 和 `y` 中选择 $p_i$，

(优先在`x`中选择，若不够就只在 `y` 中选择不足的指数)，故 `x` 和 `y` 必须互质.





